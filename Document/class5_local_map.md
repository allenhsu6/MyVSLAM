## 改进SLAM前端： 第二版

从上一讲，我们可以看到，在引入迭代优化方法之后，估计结果的质量比纯粹RanSACPNP方法有明显的提升。尽管我们依然仅使用两两帧间的信息，但得到的运动却更加准确、平稳。（这部分可以通过与groudtruth对比求取，或许会用到ICP轨迹对齐）



从第一版本的改进中,我们看到了优化的重要性。但是它仍受两两帧间匹配的局限性影响。一旦视频序列当中某个帧丢失，就会导致后续的帧也无法和上一帧匹配。



### 思路

在第二版中，我们将地图引入到vo中。大致思路如下：将VO两帧间的匹配特征点放到地图中，然后将当前帧与地图点进行匹配来计算位姿。



![image-20191220135913114](/home/xu/MyVSLAM/Document/image/image-20191220135913114.png)

其中mappoint表示在世界坐标系下的三维点坐标。



### 流程





### 关键实现





### 实现中的报错







### 总结

地图分为全局地图与局部地图。

全局地图通常记录SLAM系统运行中产生的所有点，与关键帧结合，可以实现全局的位姿地图优化以及回环检测。同时输出的所有特征点有助于输出详细的环境表达。

本文提及的地图指的是把各帧特征点缓存到在一起，构成特征点的集合。由于我们只保留距离相机比较近的特征点，丢掉远的或者在视野之外的特征点，所以属于局部地图。为保证实时性，局部地图需要考虑地图规模。